<html>
<head>
    <meta charset="UTF-8">

    <style>

    body {
      margin: 1in;
      font-family: 'Futura', sans-serif;
    }

    </style>
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>

<body>
    <h1>Project 1</h1>
    <h3>Sydney Bednar, Noorejehan Umar, Victoria Eshun</h3>
    <p>Color Palette</p>
    <p style="color: #ff0050">PINK</p>
    <p style="color: #00f2ea">AQUA</p>
    <p>BLACK</p>
    <img src='palette.png' width=300 height=300 />
    <p>
    <svg id="dance" width=500 height=500>
    </svg>

</br>
    <svg id="loud" width=500 height=500>
    </svg>

</br>
    <svg id="energy" width=500 height=500>
    </svg>
</br>
    <svg id="key" width=500 height=500>
    </svg>

    <!-- <svg id="scatter" width=500 height=500>
    </svg>  -->
    </p>

    <script>
    const requestData = async function() {
        const data = await d3.csv('TikTok_songs_2022.csv', d3.autoType);
        console.log(data);

        console.log(data.loudness);

        const svg1=d3.select("svg#dance")
        const width = svg1.attr("width");
        const height = svg1.attr("height");
        const margin = {top: 50, right: 10, bottom: 50, left: 50};
        const chartWidth = width - margin.left - margin.right;
        const chartHeight = height - margin.top - margin.bottom;

        let annotations = svg1.append("g").attr("id","annotations");
        let chartArea = svg1.append("g").attr("id","points")
                        .attr("transform",`translate(${margin.left},${margin.top})`);

        const popExtent = d3.extent(data, d => d['track_pop'])
        const popScale = d3.scaleLinear()
                            .domain(popExtent)
                            .range([0, chartWidth])

        let bottomAxis = d3.axisBottom(popScale)

        annotations.append("g")
                   .attr("class", "x axis")
                   .attr("transform",`translate(${margin.left},${chartHeight+margin.top+10})`)
                   .call(bottomAxis)

        // danceability
        const danceExtent = d3.extent(data, d => d['danceability'])
        const danceScale = d3.scaleLinear()
                           .domain(danceExtent)
                           .range([chartHeight, 0])

        console.log(danceExtent)
        let danceAxis = d3.axisLeft(danceScale)

        annotations.append("g")
                  .attr("class", "y axis")
                  .attr("transform",`translate(${margin.left-10},${margin.top})`)
                  .call(danceAxis)

        let danceCircles = chartArea.selectAll("circles.dance").data(data)
                            .join("circle")
                            .attr("class", "dance")
                            .attr("r", 4)
                            .attr("cx", d => popScale(d['track_pop']))
                            .attr("cy", d => danceScale(d['danceability']))
                            .attr("fill", "#ff0050")
                            .attr("opacity", .6)

        chartArea.append("text")
                .attr("x", (chartWidth / 2))
                .attr("y", 0 - (margin.top / 2))
                .attr("text-anchor", "middle")
                .style("font-size", "16px")
                .text("Danceability");

        // loudness
        const svg2=d3.select("svg#loud")

        let annotations2 = svg2.append("g").attr("id","annotations2");
        let chartArea2 = svg2.append("g").attr("id","points2")
                        .attr("transform",`translate(${margin.left},${margin.top})`);


        annotations2.append("g")
                   .attr("class", "x axis")
                   .attr("transform",`translate(${margin.left},${chartHeight+margin.top+10})`)
                   .call(bottomAxis)

        // points
        const loudExtent = d3.extent(data, d => d['loudness']);
        const loudScale = d3.scaleLinear()
                           .domain(loudExtent)
                           .range([chartHeight, 0]);
        let loudAxis = d3.axisLeft(loudScale);

        console.log('loud extent:', loudExtent)

        annotations2.append("g")
                  .attr("class", "y axis")
                  .attr("transform",`translate(${margin.left-10},${margin.top})`)
                  .call(loudAxis);

        let loudCircles = chartArea2.selectAll("circles.loud").data(data)
                            .join("circle")
                            .attr("class", "loud")
                            .attr("r", 4)
                            .attr("cx", d => popScale(d['track_pop']))
                            .attr("cy", d => loudScale(d['loudness']))
                            .attr("fill", "#de8c9d")
                            .attr("opacity", .6);

        // chartArea2.append("text")
        //         .attr("x", (chartWidth / 2))
        //         .attr("y", 0 - (margin.top / 2))
        //         .attr("text-anchor", "middle")
        //         .style("font-size", "16px")
        //         .text("Loudness");


        // energy
        const svg3 = d3.select("svg#energy")

        let annotations3 = svg3.append("g").attr("id","annotations3");
        let chartArea3 = svg3.append("g").attr("id","points3")
                        .attr("transform",`translate(${margin.left},${margin.top})`);

        annotations3.append("g")
                   .attr("class", "x axis")
                   .attr("transform",`translate(${margin.left},${chartHeight+margin.top+10})`)
                   .call(bottomAxis)

        // points
        const energyExtent = d3.extent(data, d => d['energy']);
        const energyScale = d3.scaleLinear()
                           .domain(energyExtent)
                           .range([chartHeight, 0]);
        let energyAxis = d3.axisLeft(energyScale);

        annotations3.append("g")
                  .attr("class", "y axis")
                  .attr("transform",`translate(${margin.left-10},${margin.top})`)
                  .call(energyAxis);

        let energyCircles = chartArea3.selectAll("circles.energy").data(data)
                            .join("circle")
                            .attr("class", "energy")
                            .attr("r", 4)
                            .attr("cx", d => popScale(d['track_pop']))
                            .attr("cy", d => energyScale(d['energy']))
                            .attr("fill", "black")
                            .attr("opacity", .6);

        // key
        const svg4 = d3.select("svg#key")

        let annotations4 = svg4.append("g").attr("id","annotations4");
        let chartArea4 = svg4.append("g").attr("id","points4")
                        .attr("transform",`translate(${margin.left},${margin.top})`);

        annotations4.append("g")
                   .attr("class", "x axis")
                   .attr("transform",`translate(${margin.left},${chartHeight+margin.top+10})`)
                   .call(bottomAxis)

        // points
        const keyExtent = d3.extent(data, d => d['key']);
        const keyScale = d3.scaleLinear()
                           .domain(keyExtent)
                           .range([chartHeight, 0]);
        let keyAxis = d3.axisLeft(keyScale);

        console.log(keyExtent)

        annotations4.append("g")
                  .attr("class", "y axis")
                  .attr("transform",`translate(${margin.left-10},${margin.top})`)
                  .call(keyAxis);

        let keyCircles = chartArea4.selectAll("circles.key").data(data)
                            .join("circle")
                            .attr("class", "key")
                            .attr("r", 4)
                            .attr("cx", d => popScale(d['track_pop']))
                            .attr("cy", d => keyScale(d['key']))
                            .attr("fill", "#00f2ea")
                            .attr("opacity", .6);

    }
    requestData();

    </script>

</body>
</html>
